var ViewportDetector=function(t,e,i){return this._listeners={},this.init(t,e,i),this};ViewportDetector.prototype.init=function(t,e,i){if(Array.isArray(t))for(var n in t)this.add(t[n].selector,t[n].callback,t[n].opts);else this.add(t,e,i);this.bind()},ViewportDetector.prototype.add=function(t,e,i){if(void 0==e)throw new Error("Missing callback for "+t+" element");if(this._listeners[t]||(this._listeners[t]={el:null,opts:i,callbacks:[]}),this._listeners[t].element=document.querySelector(t),this._listeners[t].opts=i,this._listeners[t].callbacks.push(e),this._listeners[t].visible=!1,void 0==this._listeners[t].element)throw new Error("Element "+t+" not found")},ViewportDetector.prototype.bind=function(){window.addEventListener("DOMContentLoaded",this.handler.bind(this),!1),window.addEventListener("load",this.handler.bind(this),!1),window.addEventListener("scroll",this.handler.bind(this),!1),window.addEventListener("resize",this.handler.bind(this),!1)},ViewportDetector.prototype.handler=function(){window.requestAnimationFrame(this.detectAll.bind(this))},ViewportDetector.prototype.detectAll=function(){for(var t in this._listeners)this.onVisibilityChange(this._listeners[t])},ViewportDetector.prototype.onVisibilityChange=function(t){var e=this.isElementInViewport(t.element,t.opts?t.opts.marge:void 0);if(e!=t.visible){t.visible=e;for(var i in t.callbacks){var n=t.callbacks[i];"function"==typeof n&&n(t.element,e)}}},ViewportDetector.prototype.isElementInViewport=function(t,e){var i=t.getBoundingClientRect();e=e||0;return i.top<=0+window.innerHeight+e&&i.bottom>=0-e};